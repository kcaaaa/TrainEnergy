# 高铁站节能降耗管理系统 - 系统管理模块设计文档

**模块名称**：系统管理模块

**版本号**：v1.0

**修订日期**：2025-12-23

**编写人**：全流程产品技术负责人

## 1. 功能概述

### 1.1 功能描述
系统管理模块是高铁站节能降耗管理系统的核心基础模块，负责用户账号管理、权限分配、角色定义和系统参数配置等功能，确保系统的安全稳定运行和精细化权限控制。

### 1.2 设计目标
- 实现用户账号的全生命周期管理
- 提供精细化的权限控制机制
- 支持灵活的角色定义和分配
- 配置系统基础参数和运行环境
- 确保系统的安全性和可维护性

### 1.3 适用范围
本模块适用于全站管理员和单站管理员角色，用于管理系统用户、权限、角色和基础设置。

## 2. 输入输出

### 2.1 输入数据
| 输入项 | 数据类型 | 描述 | 来源 | 约束条件 |
|-------|---------|------|------|--------|
| 用户名 | 字符串 | 用户登录账号 | 用户输入 | 长度4-20字符，唯一 |
| 密码 | 字符串 | 用户登录密码 | 用户输入 | 长度8-20字符，包含字母和数字 |
| 姓名 | 字符串 | 用户真实姓名 | 用户输入 | 长度2-10字符 |
| 联系方式 | 字符串 | 用户联系电话 | 用户输入 | 11位手机号码格式 |
| 所属角色 | 字符串 | 用户分配的角色 | 下拉选择 | 必选，从角色列表中选择 |
| 所属站点 | 字符串 | 用户管理的站点 | 下拉选择 | 单站管理员/设备维护人必选 |
| 权限项 | 字符串数组 | 角色拥有的权限 | 勾选选择 | 至少选择一项 |
| 数据采集频率 | 数字 | 数据采集间隔时间 | 下拉选择 | 1-60分钟 |
| 告警通知方式 | 字符串数组 | 告警通知渠道 | 勾选选择 | 至少选择一种 |

### 2.2 输出结果
| 输出项 | 数据类型 | 描述 | 展示方式 |
|-------|---------|------|---------|
| 用户列表 | 表格 | 系统所有用户信息 | 分页表格展示 |
| 角色列表 | 表格 | 系统所有角色信息 | 分页表格展示 |
| 权限列表 | 树形结构 | 系统所有权限项 | 树形菜单展示 |
| 系统设置 | 表单 | 系统基础参数配置 | 表单展示 |
| 操作结果 | 提示信息 | 操作成功/失败反馈 | 弹窗提示 |

## 3. 功能逻辑

### 3.1 核心流程

#### 3.1.1 用户管理流程
1. 用户进入系统管理模块，选择用户管理功能
2. 系统加载用户列表数据
3. 用户执行查询、新增、编辑、删除、禁用等操作
4. 系统验证操作权限和数据有效性
5. 系统执行相应操作并返回结果
6. 用户确认操作结果

#### 3.1.2 权限管理流程
1. 用户进入系统管理模块，选择权限管理功能
2. 系统加载权限树结构
3. 用户选择角色并配置权限
4. 系统验证操作权限
5. 系统保存权限配置并返回结果
6. 用户确认操作结果

#### 3.1.3 角色管理流程
1. 用户进入系统管理模块，选择角色管理功能
2. 系统加载角色列表数据
3. 用户执行查询、新增、编辑、删除等操作
4. 系统验证操作权限和数据有效性
5. 系统执行相应操作并返回结果
6. 用户确认操作结果

#### 3.1.4 系统设置流程
1. 用户进入系统管理模块，选择系统设置功能
2. 系统加载当前系统配置
3. 用户修改系统参数
4. 系统验证操作权限和数据有效性
5. 系统保存配置并返回结果
6. 用户确认操作结果

### 3.2 子功能说明

#### 3.2.1 用户管理
- **用户查询**：支持按用户名、姓名、角色、站点等条件进行模糊查询
- **用户新增**：创建新用户账号，设置基本信息和分配角色
- **用户编辑**：修改现有用户的基本信息和角色分配
- **用户删除**：删除不再使用的用户账号
- **用户禁用**：临时禁用用户账号，保留用户信息

#### 3.2.2 权限管理
- **权限查看**：查看系统所有权限项的树形结构
- **角色权限配置**：为指定角色分配或取消权限
- **权限批量分配**：同时为多个角色分配相同的权限
- **权限验证**：系统后台自动验证用户操作权限

#### 3.2.3 角色管理
- **角色查询**：支持按角色名称进行模糊查询
- **角色新增**：创建新角色并设置角色名称和描述
- **角色编辑**：修改现有角色的名称和描述
- **角色删除**：删除不再使用的角色
- **角色权限查看**：查看指定角色拥有的权限

#### 3.2.4 系统设置
- **数据采集频率设置**：配置能耗数据的采集间隔时间
- **告警通知方式配置**：设置告警通知的渠道（系统内、短信、邮件、移动端）
- **系统语言和时区设置**：配置系统界面语言和时区
- **数据备份策略配置**：设置数据备份的频率和方式
- **系统日志管理**：查看和导出系统操作日志

### 3.3 业务规则
- **最小权限原则**：用户仅获得完成工作所需的最小权限
- **权限继承原则**：高级别角色自动继承低级别角色的权限
- **按站划分原则**：除全站管理员外，其他角色权限均按高铁站范围划分
- **功能权限分离**：管理权限与操作权限分离，确保系统安全
- **密码安全规则**：密码长度不少于8位，包含字母和数字
- **用户名唯一性**：系统内用户名必须唯一

## 4. 数据流向

### 4.1 数据流程图
```
用户输入 → 系统验证 → 业务处理 → 数据存储 → 结果返回
```

### 4.2 数据存储
- **用户数据**：存储用户账号信息，包括用户名、密码、姓名、联系方式、所属角色、所属站点等
- **角色数据**：存储角色信息，包括角色名称、描述等
- **权限数据**：存储权限项信息，包括权限名称、描述、层级关系等
- **角色权限关系**：存储角色与权限的关联关系
- **系统配置数据**：存储系统基础参数配置，包括数据采集频率、告警通知方式等

### 4.3 数据关联
- 用户与角色：多对一关系，一个用户只能分配一个角色
- 角色与权限：多对多关系，一个角色可以拥有多个权限，一个权限可以分配给多个角色
- 角色与站点：多对多关系，一个角色可以管理多个站点，一个站点可以有多个角色管理

## 5. 功能交互

### 5.1 界面原型

#### 5.1.1 用户管理界面
- **顶部**：查询条件区域（用户名、姓名、角色、站点）和操作按钮（新增用户）
- **中部**：用户列表表格（用户名、姓名、联系方式、角色、所属站点、状态、操作）
- **底部**：分页控件
- **新增/编辑弹窗**：用户信息表单（用户名、密码、姓名、联系方式、角色、所属站点）

#### 5.1.2 权限管理界面
- **左侧**：角色列表树
- **右侧**：权限树结构（可勾选）和操作按钮（保存权限）

#### 5.1.3 角色管理界面
- **顶部**：查询条件区域（角色名称）和操作按钮（新增角色）
- **中部**：角色列表表格（角色名称、描述、权限数量、操作）
- **底部**：分页控件
- **新增/编辑弹窗**：角色信息表单（角色名称、描述）

#### 5.1.4 系统设置界面
- **选项卡**：数据采集设置、告警通知设置、系统语言设置、数据备份设置、系统日志
- **每个选项卡**：对应的配置表单
- **底部**：保存按钮

### 5.2 交互流程

#### 5.2.1 新增用户流程
1. 用户点击"新增用户"按钮
2. 系统弹出新增用户表单
3. 用户填写用户信息并选择角色和站点
4. 用户点击"保存"按钮
5. 系统验证表单数据有效性
6. 系统创建用户账号并返回结果
7. 系统提示操作成功并刷新用户列表

#### 5.2.2 配置角色权限流程
1. 用户在权限管理界面选择一个角色
2. 系统加载该角色当前拥有的权限
3. 用户勾选或取消勾选权限项
4. 用户点击"保存权限"按钮
5. 系统验证权限配置
6. 系统保存权限配置并返回结果
7. 系统提示操作成功

### 5.3 操作说明

#### 5.3.1 用户管理操作
- **查询**：在查询条件中输入关键字，点击"查询"按钮
- **新增**：点击"新增用户"按钮，填写表单信息，点击"保存"按钮
- **编辑**：在用户列表中点击"编辑"按钮，修改表单信息，点击"保存"按钮
- **删除**：在用户列表中点击"删除"按钮，确认删除后系统执行删除操作
- **禁用**：在用户列表中点击"禁用"按钮，系统将用户状态改为禁用

#### 5.3.2 角色管理操作
- **查询**：在查询条件中输入角色名称，点击"查询"按钮
- **新增**：点击"新增角色"按钮，填写表单信息，点击"保存"按钮
- **编辑**：在角色列表中点击"编辑"按钮，修改表单信息，点击"保存"按钮
- **删除**：在角色列表中点击"删除"按钮，确认删除后系统执行删除操作

#### 5.3.3 权限管理操作
- **选择角色**：在左侧角色列表中点击选择角色
- **配置权限**：在右侧权限树中勾选或取消勾选权限项
- **保存权限**：点击"保存权限"按钮，系统保存权限配置

#### 5.3.4 系统设置操作
- **切换选项卡**：点击不同的选项卡切换配置页面
- **修改配置**：在对应表单中修改配置参数
- **保存配置**：点击"保存"按钮，系统保存配置参数

## 6. 功能字段

### 6.1 核心字段定义

#### 6.1.1 用户表
| 字段名称 | 数据类型 | 长度 | 约束条件 | 描述 |
|---------|---------|------|--------|------|
| user_id | 字符串 | 32 | 主键，唯一 | 用户ID |
| username | 字符串 | 20 | 唯一，非空 | 用户名 |
| password | 字符串 | 128 | 非空 | 密码（加密存储） |
| real_name | 字符串 | 10 | 非空 | 真实姓名 |
| contact | 字符串 | 11 | 手机号格式 | 联系方式 |
| role_id | 字符串 | 32 | 非空 | 角色ID |
| station_id | 字符串 | 32 | 可空 | 所属站点ID |
| status | 字符串 | 1 | 非空，默认1 | 状态（1：启用，0：禁用） |
| create_time | 日期时间 | - | 非空 | 创建时间 |
| update_time | 日期时间 | - | 非空 | 更新时间 |

#### 6.1.2 角色表
| 字段名称 | 数据类型 | 长度 | 约束条件 | 描述 |
|---------|---------|------|--------|------|
| role_id | 字符串 | 32 | 主键，唯一 | 角色ID |
| role_name | 字符串 | 20 | 唯一，非空 | 角色名称 |
| description | 字符串 | 100 | 可空 | 角色描述 |
| create_time | 日期时间 | - | 非空 | 创建时间 |
| update_time | 日期时间 | - | 非空 | 更新时间 |

#### 6.1.3 权限表
| 字段名称 | 数据类型 | 长度 | 约束条件 | 描述 |
|---------|---------|------|--------|------|
| permission_id | 字符串 | 32 | 主键，唯一 | 权限ID |
| permission_name | 字符串 | 50 | 非空 | 权限名称 |
| description | 字符串 | 100 | 可空 | 权限描述 |
| parent_id | 字符串 | 32 | 可空 | 父权限ID |
| level | 数字 | 1 | 非空，默认1 | 权限层级 |
| sort | 数字 | 3 | 非空，默认0 | 排序字段 |

#### 6.1.4 角色权限关系表
| 字段名称 | 数据类型 | 长度 | 约束条件 | 描述 |
|---------|---------|------|--------|------|
| role_permission_id | 字符串 | 32 | 主键，唯一 | 角色权限关系ID |
| role_id | 字符串 | 32 | 非空 | 角色ID |
| permission_id | 字符串 | 32 | 非空 | 权限ID |

#### 6.1.5 系统配置表
| 字段名称 | 数据类型 | 长度 | 约束条件 | 描述 |
|---------|---------|------|--------|------|
| config_id | 字符串 | 32 | 主键，唯一 | 配置ID |
| config_key | 字符串 | 50 | 唯一，非空 | 配置键 |
| config_value | 字符串 | 255 | 可空 | 配置值 |
| description | 字符串 | 100 | 可空 | 配置描述 |
| update_time | 日期时间 | - | 非空 | 更新时间 |

### 6.2 扩展字段
| 字段名称 | 数据类型 | 长度 | 约束条件 | 描述 |
|---------|---------|------|--------|------|
| last_login_time | 日期时间 | - | 可空 | 最后登录时间 |
| last_login_ip | 字符串 | 15 | 可空 | 最后登录IP |
| login_count | 数字 | 10 | 非空，默认0 | 登录次数 |
| data_format | 字符串 | 10 | 可空 | 数据展示格式 |
| theme | 字符串 | 10 | 可空 | 系统主题 |

## 7. 异常情况处理

### 7.1 异常类型
- **权限不足**：用户尝试执行没有权限的操作
- **数据验证失败**：用户输入的数据不符合规则
- **用户名重复**：新增或修改用户时，用户名已存在
- **角色正在使用**：删除角色时，该角色仍被用户使用
- **系统错误**：系统内部发生异常

### 7.2 异常处理机制
- **权限不足**：系统提示"您没有执行此操作的权限"，并返回上一级页面
- **数据验证失败**：系统在表单字段旁显示错误提示信息，说明具体的错误原因
- **用户名重复**：系统提示"用户名已存在，请重新输入"，并将焦点定位到用户名输入框
- **角色正在使用**：系统提示"该角色正在被用户使用，无法删除"，并禁用删除按钮
- **系统错误**：系统提示"系统内部发生错误，请稍后重试"，并记录详细错误日志

### 7.3 容错设计
- **表单验证**：在客户端和服务端都进行表单验证，确保数据有效性
- **事务处理**：对涉及多表操作的业务逻辑使用事务处理，确保数据一致性
- **日志记录**：记录系统操作日志和错误日志，便于问题追踪和排查
- **权限拦截**：在系统层面拦截没有权限的操作，确保系统安全

## 8. 性能要求

### 8.1 响应时间
- 用户列表查询响应时间：≤1秒
- 角色列表查询响应时间：≤1秒
- 权限树加载响应时间：≤1秒
- 表单提交响应时间：≤2秒

### 8.2 资源占用
- 内存占用：≤100MB
- CPU占用：≤10%
- 并发用户数：支持100个并发用户

## 9. 安全要求

### 9.1 权限控制
- **操作权限控制**：对系统管理模块的所有操作进行权限验证
- **数据范围控制**：单站管理员只能管理本站的用户和数据
- **敏感操作日志**：记录所有敏感操作（如用户删除、权限修改）的详细日志

### 9.2 数据安全
- **密码加密**：用户密码使用加盐哈希算法加密存储
- **数据传输加密**：使用HTTPS协议进行数据传输
- **数据备份**：定期备份用户、角色、权限等核心数据
- **SQL注入防护**：对所有用户输入进行SQL注入防护

## 10. 测试要点

### 10.1 功能测试
- **用户管理**：测试用户新增、编辑、删除、禁用等功能
- **角色管理**：测试角色新增、编辑、删除等功能
- **权限管理**：测试角色权限分配、权限验证等功能
- **系统设置**：测试系统参数配置、保存等功能
- **权限验证**：测试不同角色的权限控制效果

### 10.2 性能测试
- **并发测试**：测试100个并发用户同时访问系统管理模块
- **响应时间测试**：测试各功能的响应时间是否符合要求
- **负载测试**：测试系统在高负载下的稳定性

### 10.3 兼容性测试
- **浏览器兼容性**：测试在Chrome、Firefox、Safari、Edge等主流浏览器中的表现
- **操作系统兼容性**：测试在Windows、MacOS等操作系统中的表现

## 11. 依赖关系

### 11.1 内部依赖
- **用户认证模块**：验证用户身份和权限
- **日志模块**：记录系统操作日志

### 11.2 外部依赖
- **加密算法库**：用于密码加密存储
- **时间处理库**：用于处理日期时间数据

## 12. 变更记录

| 版本号 | 变更日期 | 变更内容 | 变更人 |
|-------|---------|---------|--------|
| v1.0 | 2025-12-23 | 初始版本，完成系统管理模块设计 | 全流程产品技术负责人 |