# 节能策略模拟模块设计文档

## 1. 功能概述
节能策略模拟模块用于实现节能策略的创建、模拟、评估和应用，帮助高铁站管理者制定科学合理的节能方案。该模块提供丰富的节能策略模板库，支持用户快速应用预设策略，同时允许自定义策略参数。通过模拟不同节能策略的效果，预测节能潜力和经济效益，为实际节能措施的实施提供数据支持。

## 2. 输入/输出示例
### 2.1 输入
| 输入项 | 描述 | 数据类型 | 约束条件 |
|--------|------|----------|----------|
| 选择策略类型 | 节能策略的类型（如照明系统、空调系统、通风系统） | 单选 | 必选 |
| 选择策略模板 | 预设的节能策略模板 | 单选 | 可选（或自定义策略） |
| 自定义策略参数 | 策略的具体参数设置（如温度阈值、运行时间、功率限制） | 数值/选项 | 根据策略类型而定 |
| 模拟时间范围 | 策略模拟的时间范围 | 日期区间 | 必选 |
| 应用站点/区域 | 策略应用的站点或区域 | 多选 | 必选 |
| 预期目标 | 策略的预期节能目标（如节能率、能耗降低量） | 数值 | 可选 |

### 2.2 输出
| 输出项 | 描述 | 数据类型 | 展示形式 |
|--------|------|----------|----------|
| 策略模拟结果 | 模拟策略实施后的能耗预测数据 | 图表/表格 | 折线图/柱状图/数据表格 |
| 节能潜力评估 | 策略的节能潜力分析结果 | 文本/图表 | 节能率、能耗降低量、经济效益 |
| 策略实施建议 | 基于模拟结果的实施建议 | 文本 | 实施步骤、注意事项、优先级 |
| 策略对比结果 | 不同策略之间的对比分析 | 图表 | 雷达图/对比表格 |
| 策略应用状态 | 策略应用的实时状态 | 文本/图标 | 应用中/已完成/失败 |

## 3. 功能逻辑详细描述

### 3.1 节能策略模板管理

#### 3.1.1 预置策略模板
1. 系统内置常见节能场景的策略模板，包括：
   - 照明系统：办公区照明自动控制、公共区域照明定时控制、自然光感应调节
   - 空调系统：温度自动调节、分区温控、夜间节能模式
   - 通风系统：按需通风、时段控制、CO₂浓度感应调节
   - 动力系统：设备负载优化、电机变频控制、错峰运行
   - 综合节能：多系统协同控制、季节性节能方案、节假日节能模式

2. 每个模板包含：
   - 模板名称和描述
   - 适用系统和场景
   - 默认参数设置
   - 预期节能效果
   - 应用条件和限制

#### 3.1.2 模板选择与应用
1. 用户可通过分类浏览或搜索选择合适的策略模板
2. 选择模板后，系统自动加载默认参数设置
3. 用户可基于模板进行参数调整，生成自定义策略
4. 支持将自定义策略保存为新模板（仅对当前用户可见）

### 3.2 自定义策略创建

#### 3.2.1 策略参数设置
1. 提供可视化参数配置界面，根据策略类型动态显示可配置参数
2. 参数类型包括：
   - 数值型：温度阈值、时间设置、功率限制等
   - 选择型：控制模式、运行时段、优先级等
   - 开关型：功能启用/禁用

3. 参数配置支持：
   - 实时校验参数有效性
   - 提供参数建议值和范围
   - 支持批量参数导入

#### 3.2.2 策略条件设置
1. 支持设置策略触发条件：
   - 时间条件：特定日期、时段、星期
   - 环境条件：温度、湿度、光照强度
   - 负载条件：设备负载率、能耗水平
   - 事件条件：节假日、特殊活动

2. 条件组合支持逻辑运算符（与/或/非）

### 3.3 策略模拟与评估

#### 3.3.1 模拟运行
1. 基于历史能耗数据和当前运行状态，模拟策略实施效果
2. 支持不同时间粒度的模拟（小时/日/周/月）
3. 模拟过程中实时显示能耗变化趋势

#### 3.3.2 节能效果评估
1. 计算模拟的节能效果指标：
   - 节能率：能耗降低百分比
   - 节能量：实际能耗降低量（千瓦时）
   - 经济效益：节省的能源费用
   - 投资回报率：节能收益与实施成本的比值

2. 生成多维度评估报告：
   - 时间维度：不同时段的节能效果
   - 区域维度：不同区域的节能贡献
   - 系统维度：不同设备系统的节能表现

### 3.4 策略应用与监控

#### 3.4.1 策略部署
1. 支持批量部署策略到多个站点或区域
2. 提供策略部署计划功能，可设置未来实施时间
3. 部署前进行冲突检测，避免策略冲突

#### 3.4.2 策略执行监控
1. 实时监控策略执行状态和效果
2. 记录策略执行日志，包括触发条件、执行动作、实际效果
3. 支持策略暂停、恢复、终止等操作

#### 3.4.3 效果验证
1. 对比策略实施前后的能耗数据
2. 分析实际节能效果与模拟结果的差异
3. 自动生成效果验证报告

### 3.5 策略优化与迭代

#### 3.5.1 自动优化建议
1. 基于实际运行数据，为策略参数提供优化建议
2. 支持机器学习算法，不断优化策略效果

#### 3.5.2 策略版本管理
1. 记录策略的修改历史和版本变化
2. 支持回滚到之前的策略版本
3. 提供版本对比功能

## 4. 数据流向图

```
[用户选择策略模板/创建自定义策略] → [设置策略参数和条件] → [执行策略模拟] → [后台获取历史能耗数据] → [进行能耗预测计算] → [生成模拟结果和评估报告] → [用户查看模拟结果] → [确认应用策略] → [策略部署到站点] → [监控策略执行效果] → [生成效果验证报告] → [策略优化迭代]
```

## 5. 功能点击交互流程

1. **进入策略模拟页面**
   - 用户从导航菜单点击"节能策略模拟"选项
   - 页面加载策略模板库和策略创建界面

2. **选择策略模板**
   - 在策略模板库中浏览或搜索所需模板
   - 点击模板卡片查看模板详情
   - 点击"应用模板"按钮加载模板参数

3. **自定义策略参数**
   - 在参数配置界面调整策略参数
   - 设置策略触发条件和应用范围
   - 点击"保存为新模板"可将自定义策略保存

4. **执行策略模拟**
   - 选择模拟时间范围
   - 点击"开始模拟"按钮
   - 页面显示模拟进度和实时能耗变化

5. **查看模拟结果**
   - 模拟完成后，查看能耗预测图表和评估报告
   - 比较不同策略的模拟效果
   - 分析节能潜力和经济效益

6. **应用策略**
   - 选择要应用策略的站点或区域
   - 点击"应用策略"按钮
   - 确认策略应用信息

7. **监控策略执行**
   - 在策略监控页面查看已应用策略的执行状态
   - 查看策略执行日志和实际效果
   - 对策略进行暂停、恢复或终止操作

8. **查看效果验证报告**
   - 策略实施一段时间后，查看效果验证报告
   - 对比实际效果与模拟结果
   - 接收策略优化建议

## 6. 功能字段详细说明

| 字段名称 | 字段类型 | 长度 | 是否必填 | 约束条件 | 描述 |
|----------|----------|------|----------|----------|------|
| 策略ID | String | 32 | 是 | 唯一标识符 | 节能策略的唯一标识 |
| 策略名称 | String | 100 | 是 | - | 策略的名称 |
| 策略类型 | String | 50 | 是 | 照明/空调/通风/动力/综合 | 策略所属的系统类型 |
| 模板ID | String | 32 | 否 | - | 关联的策略模板ID |
| 模板名称 | String | 100 | 否 | - | 策略模板的名称 |
| 参数配置 | JSON | - | 是 | - | 策略的详细参数配置 |
| 触发条件 | JSON | - | 否 | - | 策略触发的条件设置 |
| 应用范围 | JSON | - | 是 | - | 策略应用的站点和区域 |
| 预期节能率 | Float | - | 否 | 0-100 | 预期的节能百分比 |
| 预期节能量 | Float | - | 否 | ≥0 | 预期的能耗降低量（千瓦时） |
| 创建时间 | DateTime | - | 是 | - | 策略创建的时间 |
| 创建人 | String | 50 | 是 | - | 策略创建人 |
| 状态 | String | 20 | 是 | 草稿/已发布/已应用/已终止 | 策略的当前状态 |
| 模拟结果 | JSON | - | 否 | - | 策略模拟的结果数据 |
| 实际效果 | JSON | - | 否 | - | 策略实际应用的效果数据 |

## 7. 异常情况处理

| 异常场景 | 异常描述 | 处理方式 | 系统反馈 |
|----------|----------|----------|----------|
| 未选择策略类型 | 用户未选择策略类型 | 前端校验 | 提示"请选择策略类型" |
| 参数设置不完整 | 策略参数设置不完整或无效 | 前端校验 | 提示"请完整设置策略参数" |
| 触发条件冲突 | 设置的触发条件存在逻辑冲突 | 前端校验 | 提示"触发条件存在冲突，请重新设置" |
| 模拟数据不足 | 模拟所需的历史数据不足 | 数据处理 | 提示"历史数据不足，无法进行模拟" |
| 模拟计算失败 | 策略模拟计算过程中出现错误 | 错误处理 | 提示"模拟计算失败，请稍后重试" |
| 策略应用失败 | 策略应用到站点时失败 | 错误处理 | 提示"策略应用失败，请检查站点状态" |
| 策略冲突 | 应用的策略与现有策略存在冲突 | 冲突检测 | 提示"当前策略与已有策略存在冲突，请解决冲突后重试" |
| 权限不足 | 用户没有应用策略的权限 | 权限校验 | 提示"您没有权限应用此策略" |
| 模板加载失败 | 策略模板加载失败 | 错误处理 | 提示"模板加载失败，请稍后重试" |
| 自定义模板保存失败 | 自定义策略模板保存失败 | 错误处理 | 提示"模板保存失败，请稍后重试" |

## 8. 性能要求

| 性能指标 | 要求 | 说明 |
|----------|------|------|
| 页面加载时间 | ≤3秒 | 页面初始化加载完成时间 |
| 模板加载时间 | ≤1秒 | 策略模板加载完成时间 |
| 模拟计算时间 | ≤5秒 | 策略模拟计算完成时间 |
| 策略应用响应时间 | ≤2秒 | 策略应用命令响应时间 |
| 支持同时模拟策略数 | 5个 | 同一用户同时模拟的策略数量 |
| 支持策略模板数量 | 100个 | 系统预置和用户自定义模板总数 |
| 并发用户数 | 1000 | 系统支持的并发用户数量 |

## 9. 安全要求

| 安全项 | 要求 | 说明 |
|--------|------|------|
| 权限控制 | 基于角色的访问控制 | 不同角色拥有不同的策略操作权限 |
| 数据加密 | 传输加密 | 策略数据传输过程中采用HTTPS加密 |
| 操作日志 | 记录用户操作 | 记录策略创建、修改、应用、删除等操作日志 |
| 策略版本控制 | 保留策略历史版本 | 防止策略被恶意修改，支持版本回滚 |
| 输入验证 | 严格验证用户输入 | 防止注入攻击和非法参数 |
| 策略隔离 | 用户间策略隔离 | 不同用户的自定义策略相互隔离 |

## 10. 测试点

| 测试项 | 测试内容 | 期望结果 |
|--------|----------|----------|
| 策略模板浏览与搜索 | 验证模板分类浏览和搜索功能 | 能正确显示模板列表，搜索结果准确 |
| 模板应用与参数加载 | 验证模板应用和参数加载功能 | 模板参数能正确加载到配置界面 |
| 自定义策略创建 | 验证自定义策略的创建功能 | 能成功创建并保存自定义策略 |
| 策略参数配置 | 验证参数配置的有效性和实时校验 | 参数校验准确，错误提示清晰 |
| 触发条件设置 | 验证触发条件的设置和逻辑组合 | 条件设置正确，逻辑组合有效 |
| 策略模拟功能 | 验证策略模拟的执行和结果生成 | 模拟过程正常，结果数据准确 |
| 模拟结果展示 | 验证模拟结果的图表和报告展示 | 图表渲染正常，报告内容完整 |
| 策略应用功能 | 验证策略应用到站点的功能 | 策略能成功应用到指定站点 |
| 策略冲突检测 | 验证策略冲突检测功能 | 能准确检测到策略冲突并提示 |
| 策略监控功能 | 验证策略执行状态的监控功能 | 能实时显示策略执行状态和日志 |
| 效果验证报告 | 验证效果验证报告的生成功能 | 报告内容准确，数据对比清晰 |
| 异常情况处理 | 验证各种异常场景的处理 | 异常提示准确，系统处理合理 |

## 11. 依赖关系

| 依赖项 | 描述 | 依赖类型 |
|--------|------|----------|
| 能耗历史数据 | 策略模拟所需的历史能耗数据 | 数据依赖 |
| 站点设备信息 | 策略应用的站点和设备信息 | 数据依赖 |
| 实时监控数据 | 策略执行监控所需的实时数据 | 数据依赖 |
| 用户权限系统 | 策略操作的权限控制 | 服务依赖 |
| 数据存储服务 | 策略模板和配置数据的存储 | 服务依赖 |
| 计算引擎服务 | 策略模拟的计算处理 | 服务依赖 |

## 12. 功能变更记录

| 版本号 | 变更日期 | 变更内容 | 变更人 | 审核人 |
|--------|----------|----------|--------|--------|
| V1.0 | 2023-11-15 | 初始版本 | 张工 | 李工 |
| V1.1 | 2023-11-22 | 增加节能策略模板功能，预置常见节能场景模板 | 王工 | 赵工 |
| V1.2 | 2023-11-28 | 优化策略模拟算法，提高模拟精度 | 刘工 | 陈工 |

## 13. 附加说明

1. 系统预置的节能策略模板基于高铁站常见的节能场景和最佳实践开发
2. 支持将自定义策略分享给其他用户或站点
3. 策略模拟结果可导出为PDF或Excel格式的报告
4. 提供策略实施的优先级建议，帮助管理者合理安排节能措施
5. 支持与能耗分析预警系统集成，根据预警信息自动推荐节能策略