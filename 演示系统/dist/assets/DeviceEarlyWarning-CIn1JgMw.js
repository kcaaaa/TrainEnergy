import{A as e,C as t,D as n,E as r,M as i,O as a,S as ee,T as o,_ as s,b as c,c as l,d as u,f as d,g as f,h as p,k as m,l as te,p as h,r as g,s as _,t as v,u as y,w as b,x,y as S}from"./index-DexfLrHx.js";var C={name:`DeviceEarlyWarning`,setup(){let e=m(!1),t=m(!1),n=m(!1),r=m(!1),i=m(!1),ee=m(`list`),l=m(`day`),u=m(``),d=m(``),f=m(``),p=m(1),h=m(10),g=m(0),_=m(null),y=m(null),b=m(null),x=m(null),C=null,w=null,T=null,E=m({criticalCount:3,warningCount:8,infoCount:15,pendingCount:12}),D=m([{id:`W001`,deviceId:`DEV001`,deviceName:`1号空调机组`,location:`候车大厅一层A区`,warningType:`温度过高`,description:`回风温度超过设定阈值`,value:28.5,threshold:26,unit:`°C`,level:`critical`,status:`pending`,createTime:new Date(Date.now()-1e3*60*30)},{id:`W002`,deviceId:`DEV003`,deviceName:`主变压器`,location:`配电室一层`,warningType:`负载过高`,description:`变压器负载率超过80%`,value:85.6,threshold:80,unit:`%`,level:`critical`,status:`processing`,createTime:new Date(Date.now()-1e3*60*45),handler:`张工`},{id:`W003`,deviceId:`DEV005`,deviceName:`3号电梯`,location:`候车大厅二层B区`,warningType:`运行异常`,description:`电梯运行抖动异常`,value:2.5,threshold:2,unit:`mm/s`,level:`warning`,status:`pending`,createTime:new Date(Date.now()-1e3*60*60)},{id:`W004`,deviceId:`DEV002`,deviceName:`2号空调机组`,location:`候车大厅一层B区`,warningType:`能耗异常`,description:`单位制冷量能耗偏高`,value:1.45,threshold:1.3,unit:`kWh/㎡`,level:`warning`,status:`pending`,createTime:new Date(Date.now()-1e3*60*90)},{id:`W005`,deviceId:`DEV006`,deviceName:`冷却水泵`,location:`制冷机房`,warningType:`压力异常`,description:`冷却水泵出口压力偏低`,value:.35,threshold:.4,unit:`MPa`,level:`warning`,status:`processed`,createTime:new Date(Date.now()-1e3*60*120),handler:`李工`,processTime:new Date(Date.now()-1e3*60*30).toLocaleString()},{id:`W006`,deviceId:`DEV004`,deviceName:`照明配电柜`,location:`候车大厅一层`,warningType:`电压波动`,description:`电压波动超过正常范围`,value:238,threshold:235,unit:`V`,level:`info`,status:`pending`,createTime:new Date(Date.now()-1e3*60*180)},{id:`W007`,deviceId:`DEV008`,deviceName:`排风机组`,location:`地下停车场`,warningType:`CO浓度偏高`,description:`停车场CO浓度略高`,value:15,threshold:20,unit:`ppm`,level:`info`,status:`pending`,createTime:new Date(Date.now()-1e3*60*200)}]),O=m([{id:`R001`,ruleName:`空调温度过高预警`,deviceType:`ac`,metric:`回风温度`,operator:`>`,threshold:26,unit:`°C`,level:`critical`,enabled:!0},{id:`R002`,ruleName:`变压器负载预警`,deviceType:`transformer`,metric:`负载率`,operator:`>`,threshold:80,unit:`%`,level:`critical`,enabled:!0},{id:`R003`,ruleName:`电梯振动预警`,deviceType:`elevator`,metric:`振动值`,operator:`>`,threshold:2,unit:`mm/s`,level:`warning`,enabled:!0},{id:`R004`,ruleName:`空调能耗异常预警`,deviceType:`ac`,metric:`单位能耗`,operator:`>`,threshold:1.3,unit:`kWh/㎡`,level:`warning`,enabled:!0},{id:`R005`,ruleName:`电压波动预警`,deviceType:`lighting`,metric:`电压`,operator:`>`,threshold:235,unit:`V`,level:`info`,enabled:!0}]),ne=a({emailEnabled:!0,smsEnabled:!0,appEnabled:!0,soundEnabled:!1,interval:10,autoRecover:!1,retentionDays:30}),k=a({ruleName:``,deviceType:``,metric:``,operator:`>`,threshold:0,unit:``,level:`warning`}),re={ruleName:[{required:!0,message:`请输入规则名称`,trigger:`blur`}],deviceType:[{required:!0,message:`请选择设备类型`,trigger:`change`}],metric:[{required:!0,message:`请输入监控指标`,trigger:`blur`}],threshold:[{required:!0,message:`请输入阈值`,trigger:`blur`}],level:[{required:!0,message:`请选择预警级别`,trigger:`change`}]},A=a({method:``,remark:``}),ie=te(()=>D.value.filter(e=>{let t=!u.value||e.level===u.value,n=!d.value||e.status===d.value,r=!f.value||e.deviceName.includes(f.value)||e.location.includes(f.value);return t&&n&&r})),ae=()=>{y.value&&(C=v(y.value),j()),b.value&&(w=v(b.value),oe()),window.addEventListener(`resize`,M)},j=()=>{C&&C.setOption({tooltip:{trigger:`axis`},legend:{data:[`严重`,`警告`,`提示`],bottom:0},grid:{left:`3%`,right:`4%`,bottom:`15%`,top:`10%`,containLabel:!0},xAxis:{type:`category`,data:[`00:00`,`04:00`,`08:00`,`12:00`,`16:00`,`20:00`,`24:00`]},yAxis:{type:`value`},series:[{name:`严重`,type:`bar`,data:[1,0,2,1,3,2,1],itemStyle:{color:`#F56C6C`}},{name:`警告`,type:`bar`,data:[3,2,5,4,6,5,3],itemStyle:{color:`#E6A23C`}},{name:`提示`,type:`bar`,data:[5,4,8,6,10,7,5],itemStyle:{color:`#409EFF`}}]})},oe=()=>{w&&w.setOption({tooltip:{trigger:`item`,formatter:`{b}: {c}台`},series:[{name:`设备健康状态`,type:`pie`,radius:[`45%`,`70%`],data:[{value:45,name:`健康`,itemStyle:{color:`#67C23A`}},{value:8,name:`警告`,itemStyle:{color:`#E6A23C`}},{value:2,name:`故障`,itemStyle:{color:`#F56C6C`}}],label:{formatter:`{b}
{d}%`}}]})},M=()=>{C?.resize(),w?.resize(),T?.resize()},se=e=>({critical:`danger`,warning:`warning`,info:`info`})[e]||`info`,ce=e=>({critical:`严重`,warning:`警告`,info:`提示`})[e]||e,le=e=>({pending:`info`,processing:`warning`,processed:`success`})[e]||`info`,ue=e=>({pending:`待处理`,processing:`处理中`,processed:`已处理`})[e]||e,de=e=>e.operator===`>`?e.value>e.threshold?`value-warning`:`value-normal`:e.value<e.threshold?`value-warning`:`value-normal`,fe=e=>new Date(e).toLocaleString(),pe=e=>{let t=Date.now()-new Date(e).getTime(),n=Math.floor(t/6e4);if(n<60)return`${n}分钟`;let r=Math.floor(n/60);return r<24?`${r}小时`:`${Math.floor(r/24)}天${r%24}小时`},me=e=>{_.value=e,A.method=``,A.remark=``,t.value=!0,s(()=>{x.value&&(T=v(x.value),T.setOption({tooltip:{trigger:`axis`},xAxis:{type:`category`,data:[`10min前`,`5min前`,`当前`]},yAxis:{type:`value`},series:[{type:`line`,data:[e.value*.9,e.value*.95,e.value],smooth:!0,lineStyle:{color:`#F56C6C`},itemStyle:{color:`#F56C6C`}}]}))})},N=()=>{let e=D.value.find(e=>e.id===_.value.id);e&&(e.status=`processing`,e.handler=`当前用户`,e.processTime=new Date().toLocaleString()),t.value=!1,B()},P=e=>{e.status=`processed`,B()},F=()=>{D.value.forEach(e=>{e.status===`pending`&&(e.status=`processed`)}),B()},I=e=>{_.value=e,t.value=!0,s(()=>{x.value&&(T=v(x.value),T.setOption({tooltip:{trigger:`axis`},xAxis:{type:`category`,data:[`10min前`,`5min前`,`当前`]},yAxis:{type:`value`},series:[{type:`line`,data:[e.value*.9,e.value*.95,e.value],smooth:!0,lineStyle:{color:`#409EFF`},itemStyle:{color:`#409EFF`}}]}))})},L=()=>{},R=()=>{n.value=!0},z=()=>{n.value=!1},he=()=>{i.value=!1,k.ruleName=``,k.deviceType=``,k.metric=``,k.operator=`>`,k.threshold=0,k.unit=``,k.level=`warning`,r.value=!0},ge=e=>{i.value=!0,Object.assign(k,e),r.value=!0},_e=e=>{let t=O.value.findIndex(t=>t.id===e.id);t>-1&&O.value.splice(t,1)},ve=e=>{},ye=()=>{if(i.value){let e=O.value.find(e=>e.id===k.id);e&&Object.assign(e,k)}else O.value.push({id:`R${Date.now()}`,...k,enabled:!0});r.value=!1},be=()=>{},xe=()=>{},B=()=>{E.value.criticalCount=D.value.filter(e=>e.level===`critical`&&e.status!==`processed`).length,E.value.warningCount=D.value.filter(e=>e.level===`warning`&&e.status!==`processed`).length,E.value.infoCount=D.value.filter(e=>e.level===`info`&&e.status!==`processed`).length,E.value.pendingCount=D.value.filter(e=>e.status===`pending`).length};return S(()=>{g.value=D.value.length,s(()=>{ae()})}),c(()=>{window.removeEventListener(`resize`,M),C?.dispose(),w?.dispose(),T?.dispose()}),o(l,()=>{j()}),{loading:e,showDetailDialog:t,showSettingsDialog:n,showRuleDialog:r,isEditRule:i,viewMode:ee,trendPeriod:l,warningLevel:u,warningStatus:d,searchKeyword:f,currentPage:p,pageSize:h,totalWarnings:g,currentWarning:_,stats:E,filteredWarnings:ie,warningRules:O,settingsForm:ne,ruleForm:k,ruleFormRules:re,processForm:A,trendChartRef:y,healthChartRef:b,historyChartRef:x,handleProcess:me,handleSubmitProcess:N,handleAcknowledge:P,handleAcknowledgeAll:F,handleViewDetail:I,handleExport:L,handleSettings:R,handleSaveSettings:z,handleAddRule:he,handleEditRule:ge,handleDeleteRule:_e,handleRuleStatusChange:ve,handleSubmitRule:ye,handlePageSizeChange:be,handlePageChange:xe,getLevelType:se,getLevelName:ce,getStatusType:le,getStatusName:ue,getValueClass:de,formatTime:fe,getDuration:pe}}},w={class:`device-early-warning`},T={class:`toolbar`},E={class:`toolbar-right`},D={class:`stats-section`},O={class:`stat-content`},ne={class:`stat-info`},k={class:`stat-value`},re={class:`stat-content`},A={class:`stat-info`},ie={class:`stat-value`},ae={class:`stat-content`},j={class:`stat-info`},oe={class:`stat-value`},M={class:`stat-content`},se={class:`stat-info`},ce={class:`stat-value`},le={class:`main-content`},ue={class:`card-header`},de={class:`header-actions`},fe={key:0,class:`warning-list`},pe={class:`pagination-section`},me={key:1,class:`warning-cards`},N=[`onClick`],P={class:`card-header`},F={class:`card-time`},I={class:`card-body`},L={class:`location`},R={class:`warning-type`},z={class:`description`},he={class:`value-info`},ge={class:`current-value`},_e={class:`threshold`},ve={class:`card-footer`},ye={class:`card-actions`},be={class:`card-header`},xe={class:`header-actions`},B={ref:`trendChartRef`,class:`trend-chart`},Se={ref:`healthChartRef`,class:`health-chart`},Ce={class:`rules-section`},we={class:`card-header`},Te={key:0,class:`detail-content`},Ee={class:`threshold-info`},De={class:`history-chart`},Oe={ref:`historyChartRef`,class:`history-trend-chart`},ke={key:0,class:`process-section`};function V(a,o,s,c,m,te){let g=t(`el-button`),v=t(`el-option`),S=t(`el-select`),C=t(`el-input`),V=t(`el-card`),H=t(`el-col`),U=t(`el-row`),W=t(`el-radio-button`),Ae=t(`el-radio-group`),G=t(`el-tag`),K=t(`el-table-column`),je=t(`el-table`),Me=t(`el-pagination`),q=t(`el-switch`),J=t(`el-descriptions-item`),Ne=t(`el-descriptions`),Y=t(`el-form-item`),X=t(`el-form`),Z=t(`el-dialog`),Q=t(`el-divider`),Pe=t(`el-input-number`),$=b(`loading`);return x(),h(`div`,w,[y(`div`,T,[f(g,{type:`danger`,onClick:c.handleAcknowledgeAll},{default:r(()=>[...o[29]||=[y(`i`,{class:`fa fa-check-square`},null,-1),p(` 一键已读 `,-1)]]),_:1},8,[`onClick`]),f(g,{type:`warning`,onClick:c.handleExport},{default:r(()=>[...o[30]||=[y(`i`,{class:`fa fa-download`},null,-1),p(` 导出报告 `,-1)]]),_:1},8,[`onClick`]),f(g,{type:`info`,onClick:c.handleSettings},{default:r(()=>[...o[31]||=[y(`i`,{class:`fa fa-cog`},null,-1),p(` 预警设置 `,-1)]]),_:1},8,[`onClick`]),y(`div`,E,[f(S,{modelValue:c.warningLevel,"onUpdate:modelValue":o[0]||=e=>c.warningLevel=e,placeholder:`预警级别`,clearable:``,style:{width:`120px`}},{default:r(()=>[f(v,{label:`全部`,value:``}),f(v,{label:`严重`,value:`critical`}),f(v,{label:`警告`,value:`warning`}),f(v,{label:`提示`,value:`info`})]),_:1},8,[`modelValue`]),f(S,{modelValue:c.warningStatus,"onUpdate:modelValue":o[1]||=e=>c.warningStatus=e,placeholder:`状态`,clearable:``,style:{width:`120px`,"margin-left":`10px`}},{default:r(()=>[f(v,{label:`全部`,value:``}),f(v,{label:`未处理`,value:`pending`}),f(v,{label:`处理中`,value:`processing`}),f(v,{label:`已处理`,value:`processed`})]),_:1},8,[`modelValue`]),f(C,{modelValue:c.searchKeyword,"onUpdate:modelValue":o[2]||=e=>c.searchKeyword=e,placeholder:`搜索设备/位置...`,"prefix-icon":`el-icon-search`,clearable:``,style:{width:`200px`,"margin-left":`10px`}},null,8,[`modelValue`])])]),y(`div`,D,[f(U,{gutter:20},{default:r(()=>[f(H,{span:6},{default:r(()=>[f(V,{shadow:`hover`,class:`stat-card critical`},{default:r(()=>[y(`div`,O,[o[33]||=y(`div`,{class:`stat-icon`},[y(`i`,{class:`fa fa-exclamation-triangle`})],-1),y(`div`,ne,[y(`div`,k,i(c.stats.criticalCount),1),o[32]||=y(`div`,{class:`stat-label`},`严重预警`,-1)])])]),_:1})]),_:1}),f(H,{span:6},{default:r(()=>[f(V,{shadow:`hover`,class:`stat-card warning`},{default:r(()=>[y(`div`,re,[o[35]||=y(`div`,{class:`stat-icon`},[y(`i`,{class:`fa fa-exclamation-circle`})],-1),y(`div`,A,[y(`div`,ie,i(c.stats.warningCount),1),o[34]||=y(`div`,{class:`stat-label`},`警告预警`,-1)])])]),_:1})]),_:1}),f(H,{span:6},{default:r(()=>[f(V,{shadow:`hover`,class:`stat-card info`},{default:r(()=>[y(`div`,ae,[o[37]||=y(`div`,{class:`stat-icon`},[y(`i`,{class:`fa fa-info-circle`})],-1),y(`div`,j,[y(`div`,oe,i(c.stats.infoCount),1),o[36]||=y(`div`,{class:`stat-label`},`提示预警`,-1)])])]),_:1})]),_:1}),f(H,{span:6},{default:r(()=>[f(V,{shadow:`hover`,class:`stat-card pending`},{default:r(()=>[y(`div`,M,[o[39]||=y(`div`,{class:`stat-icon`},[y(`i`,{class:`fa fa-clock-o`})],-1),y(`div`,se,[y(`div`,ce,i(c.stats.pendingCount),1),o[38]||=y(`div`,{class:`stat-label`},`待处理`,-1)])])]),_:1})]),_:1})]),_:1})]),y(`div`,le,[f(U,{gutter:20},{default:r(()=>[f(H,{span:14},{default:r(()=>[f(V,{shadow:`hover`},{header:r(()=>[y(`div`,ue,[o[42]||=y(`span`,null,`实时预警列表`,-1),y(`div`,de,[f(Ae,{modelValue:c.viewMode,"onUpdate:modelValue":o[3]||=e=>c.viewMode=e,size:`small`},{default:r(()=>[f(W,{label:`list`},{default:r(()=>[...o[40]||=[y(`i`,{class:`fa fa-list`},null,-1)]]),_:1}),f(W,{label:`card`},{default:r(()=>[...o[41]||=[y(`i`,{class:`fa fa-th-large`},null,-1)]]),_:1})]),_:1},8,[`modelValue`])])])]),default:r(()=>[c.viewMode===`list`?n((x(),h(`div`,fe,[f(je,{data:c.filteredWarnings,stripe:``,"row-key":`id`,onRowClick:a.handleRowClick},{default:r(()=>[f(K,{prop:`level`,label:`级别`,width:`80`,align:`center`},{default:r(e=>[f(G,{type:c.getLevelType(e.row.level),size:`small`,effect:`dark`},{default:r(()=>[p(i(c.getLevelName(e.row.level)),1)]),_:2},1032,[`type`])]),_:1}),f(K,{prop:`deviceName`,label:`设备名称`,"min-width":`150`}),f(K,{prop:`location`,label:`位置`,width:`180`}),f(K,{prop:`warningType`,label:`预警类型`,width:`120`}),f(K,{prop:`description`,label:`预警内容`,"min-width":`200`,"show-overflow-tooltip":``}),f(K,{prop:`value`,label:`当前值`,width:`100`,align:`right`},{default:r(t=>[y(`span`,{class:e(c.getValueClass(t.row))},i(t.row.value.toFixed(2))+` `+i(t.row.unit),3)]),_:1}),f(K,{prop:`threshold`,label:`阈值`,width:`100`,align:`right`},{default:r(e=>[p(i(e.row.threshold)+` `+i(e.row.unit),1)]),_:1}),f(K,{prop:`createTime`,label:`发生时间`,width:`160`},{default:r(e=>[p(i(c.formatTime(e.row.createTime)),1)]),_:1}),f(K,{prop:`status`,label:`状态`,width:`100`,align:`center`},{default:r(e=>[f(G,{type:c.getStatusType(e.row.status),size:`small`},{default:r(()=>[p(i(c.getStatusName(e.row.status)),1)]),_:2},1032,[`type`])]),_:1}),f(K,{label:`操作`,width:`150`,align:`center`,fixed:`right`},{default:r(e=>[e.row.status===`pending`?(x(),u(g,{key:0,type:`primary`,size:`mini`,text:``,onClick:_(t=>c.handleProcess(e.row),[`stop`])},{default:r(()=>[...o[43]||=[y(`i`,{class:`fa fa-play`},null,-1),p(` 处理 `,-1)]]),_:1},8,[`onClick`])):d(``,!0),f(g,{type:`success`,size:`mini`,text:``,onClick:_(t=>c.handleAcknowledge(e.row),[`stop`])},{default:r(()=>[...o[44]||=[y(`i`,{class:`fa fa-check`},null,-1),p(` 已读 `,-1)]]),_:1},8,[`onClick`]),f(g,{type:`info`,size:`mini`,text:``,onClick:_(t=>c.handleViewDetail(e.row),[`stop`])},{default:r(()=>[...o[45]||=[y(`i`,{class:`fa fa-eye`},null,-1),p(` 详情 `,-1)]]),_:1},8,[`onClick`])]),_:1})]),_:1},8,[`data`,`onRowClick`]),y(`div`,pe,[f(Me,{"current-page":c.currentPage,"onUpdate:currentPage":o[4]||=e=>c.currentPage=e,"page-size":c.pageSize,"onUpdate:pageSize":o[5]||=e=>c.pageSize=e,"page-sizes":[10,20,50,100],total:c.totalWarnings,layout:`total, sizes, prev, pager, next, jumper`,onSizeChange:c.handlePageSizeChange,onCurrentChange:c.handlePageChange},null,8,[`current-page`,`page-size`,`total`,`onSizeChange`,`onCurrentChange`])])])),[[$,c.loading]]):n((x(),h(`div`,me,[f(U,{gutter:16},{default:r(()=>[(x(!0),h(l,null,ee(c.filteredWarnings,t=>(x(),u(H,{span:8,key:t.id},{default:r(()=>[y(`div`,{class:e([`warning-card`,t.level]),onClick:e=>c.handleViewDetail(t)},[y(`div`,P,[f(G,{type:c.getLevelType(t.level),size:`small`,effect:`dark`},{default:r(()=>[p(i(c.getLevelName(t.level)),1)]),_:2},1032,[`type`]),y(`span`,F,i(c.formatTime(t.createTime)),1)]),y(`div`,I,[y(`h4`,null,i(t.deviceName),1),y(`p`,L,[o[46]||=y(`i`,{class:`fa fa-map-marker`},null,-1),p(` `+i(t.location),1)]),y(`p`,R,[o[47]||=y(`i`,{class:`fa fa-bell`},null,-1),p(` `+i(t.warningType),1)]),y(`p`,z,i(t.description),1),y(`div`,he,[y(`span`,ge,[o[48]||=p(` 当前: `,-1),y(`b`,null,i(t.value.toFixed(2)),1),p(` `+i(t.unit),1)]),y(`span`,_e,` 阈值: `+i(t.threshold)+` `+i(t.unit),1)])]),y(`div`,ve,[f(G,{type:c.getStatusType(t.status),size:`small`},{default:r(()=>[p(i(c.getStatusName(t.status)),1)]),_:2},1032,[`type`]),y(`div`,ye,[t.status===`pending`?(x(),u(g,{key:0,size:`mini`,type:`primary`,text:``,onClick:_(e=>c.handleProcess(t),[`stop`])},{default:r(()=>[...o[49]||=[p(` 处理 `,-1)]]),_:1},8,[`onClick`])):d(``,!0),f(g,{size:`mini`,text:``,onClick:_(e=>c.handleAcknowledge(t),[`stop`])},{default:r(()=>[...o[50]||=[p(` 已读 `,-1)]]),_:1},8,[`onClick`])])])],10,N)]),_:2},1024))),128))]),_:1})])),[[$,c.loading]])]),_:1})]),_:1}),f(H,{span:10},{default:r(()=>[f(V,{shadow:`hover`},{header:r(()=>[y(`div`,be,[o[54]||=y(`span`,null,`预警趋势分析`,-1),y(`div`,xe,[f(Ae,{modelValue:c.trendPeriod,"onUpdate:modelValue":o[6]||=e=>c.trendPeriod=e,size:`small`},{default:r(()=>[f(W,{label:`day`},{default:r(()=>[...o[51]||=[p(`日`,-1)]]),_:1}),f(W,{label:`week`},{default:r(()=>[...o[52]||=[p(`周`,-1)]]),_:1}),f(W,{label:`month`},{default:r(()=>[...o[53]||=[p(`月`,-1)]]),_:1})]),_:1},8,[`modelValue`])])])]),default:r(()=>[y(`div`,B,null,512)]),_:1}),f(V,{shadow:`hover`,class:`device-status-card`},{header:r(()=>[...o[55]||=[y(`div`,{class:`card-header`},[y(`span`,null,`设备健康状态`)],-1)]]),default:r(()=>[y(`div`,Se,null,512)]),_:1})]),_:1})]),_:1})]),y(`div`,Ce,[f(V,{shadow:`hover`},{header:r(()=>[y(`div`,we,[o[57]||=y(`span`,null,`预警规则配置`,-1),f(g,{type:`primary`,size:`small`,onClick:c.handleAddRule},{default:r(()=>[...o[56]||=[y(`i`,{class:`fa fa-plus`},null,-1),p(` 新增规则 `,-1)]]),_:1},8,[`onClick`])])]),default:r(()=>[n((x(),u(je,{data:c.warningRules,stripe:``},{default:r(()=>[f(K,{prop:`ruleName`,label:`规则名称`,"min-width":`150`}),f(K,{prop:`deviceType`,label:`设备类型`,width:`120`,align:`center`}),f(K,{prop:`metric`,label:`监控指标`,width:`120`}),f(K,{prop:`condition`,label:`预警条件`,width:`200`},{default:r(e=>[p(i(e.row.metric)+` `+i(e.row.operator)+` `+i(e.row.threshold)+` `+i(e.row.unit),1)]),_:1}),f(K,{prop:`level`,label:`预警级别`,width:`100`,align:`center`},{default:r(e=>[f(G,{type:c.getLevelType(e.row.level),size:`small`},{default:r(()=>[p(i(c.getLevelName(e.row.level)),1)]),_:2},1032,[`type`])]),_:1}),f(K,{prop:`enabled`,label:`状态`,width:`100`,align:`center`},{default:r(e=>[f(q,{modelValue:e.row.enabled,"onUpdate:modelValue":t=>e.row.enabled=t,onChange:t=>c.handleRuleStatusChange(e.row)},null,8,[`modelValue`,`onUpdate:modelValue`,`onChange`])]),_:1}),f(K,{label:`操作`,width:`150`,align:`center`},{default:r(e=>[f(g,{type:`primary`,size:`mini`,text:``,onClick:t=>c.handleEditRule(e.row)},{default:r(()=>[...o[58]||=[y(`i`,{class:`fa fa-edit`},null,-1),p(` 编辑 `,-1)]]),_:1},8,[`onClick`]),f(g,{type:`danger`,size:`mini`,text:``,onClick:t=>c.handleDeleteRule(e.row)},{default:r(()=>[...o[59]||=[y(`i`,{class:`fa fa-trash`},null,-1),p(` 删除 `,-1)]]),_:1},8,[`onClick`])]),_:1})]),_:1},8,[`data`])),[[$,c.loading]])]),_:1})]),f(Z,{modelValue:c.showDetailDialog,"onUpdate:modelValue":o[10]||=e=>c.showDetailDialog=e,title:`预警详情`,width:`600px`,center:``},{footer:r(()=>[f(g,{onClick:o[9]||=e=>c.showDetailDialog=!1},{default:r(()=>[...o[62]||=[p(`关闭`,-1)]]),_:1}),c.currentWarning?.status===`pending`?(x(),u(g,{key:0,type:`primary`,onClick:c.handleSubmitProcess},{default:r(()=>[...o[63]||=[p(` 提交处理 `,-1)]]),_:1},8,[`onClick`])):d(``,!0)]),default:r(()=>[c.currentWarning?(x(),h(`div`,Te,[f(Ne,{column:2,border:``},{default:r(()=>[f(J,{label:`预警编号`},{default:r(()=>[p(i(c.currentWarning.id),1)]),_:1}),f(J,{label:`预警级别`},{default:r(()=>[f(G,{type:c.getLevelType(c.currentWarning.level),effect:`dark`},{default:r(()=>[p(i(c.getLevelName(c.currentWarning.level)),1)]),_:1},8,[`type`])]),_:1}),f(J,{label:`设备名称`},{default:r(()=>[p(i(c.currentWarning.deviceName),1)]),_:1}),f(J,{label:`设备编号`},{default:r(()=>[p(i(c.currentWarning.deviceId),1)]),_:1}),f(J,{label:`位置`},{default:r(()=>[p(i(c.currentWarning.location),1)]),_:1}),f(J,{label:`预警类型`},{default:r(()=>[p(i(c.currentWarning.warningType),1)]),_:1}),f(J,{label:`当前值`,span:2},{default:r(()=>[y(`span`,{class:e(c.getValueClass(c.currentWarning))},i(c.currentWarning.value.toFixed(2))+` `+i(c.currentWarning.unit),3),y(`span`,Ee,` (阈值: `+i(c.currentWarning.threshold)+` `+i(c.currentWarning.unit)+`)`,1)]),_:1}),f(J,{label:`预警内容`,span:2},{default:r(()=>[p(i(c.currentWarning.description),1)]),_:1}),f(J,{label:`发生时间`},{default:r(()=>[p(i(c.formatTime(c.currentWarning.createTime)),1)]),_:1}),f(J,{label:`持续时间`},{default:r(()=>[p(i(c.getDuration(c.currentWarning.createTime)),1)]),_:1}),f(J,{label:`状态`},{default:r(()=>[f(G,{type:c.getStatusType(c.currentWarning.status)},{default:r(()=>[p(i(c.getStatusName(c.currentWarning.status)),1)]),_:1},8,[`type`])]),_:1}),c.currentWarning.handler?(x(),u(J,{key:0,label:`处理人`},{default:r(()=>[p(i(c.currentWarning.handler),1)]),_:1})):d(``,!0),c.currentWarning.processTime?(x(),u(J,{key:1,label:`处理时间`},{default:r(()=>[p(i(c.currentWarning.processTime),1)]),_:1})):d(``,!0)]),_:1}),y(`div`,De,[o[60]||=y(`h4`,null,`历史趋势`,-1),y(`div`,Oe,null,512)]),c.currentWarning.status===`pending`?(x(),h(`div`,ke,[o[61]||=y(`h4`,null,`处理操作`,-1),f(X,{model:c.processForm,"label-width":`80px`},{default:r(()=>[f(Y,{label:`处理方式`},{default:r(()=>[f(S,{modelValue:c.processForm.method,"onUpdate:modelValue":o[7]||=e=>c.processForm.method=e,placeholder:`选择处理方式`,style:{width:`100%`}},{default:r(()=>[f(v,{label:`现场检查`,value:`inspection`}),f(v,{label:`远程复位`,value:`reset`}),f(v,{label:`自动修复`,value:`auto_fix`}),f(v,{label:`通知维护`,value:`maintenance`})]),_:1},8,[`modelValue`])]),_:1}),f(Y,{label:`备注`},{default:r(()=>[f(C,{modelValue:c.processForm.remark,"onUpdate:modelValue":o[8]||=e=>c.processForm.remark=e,type:`textarea`,rows:3,placeholder:`请输入处理备注`},null,8,[`modelValue`])]),_:1})]),_:1},8,[`model`])])):d(``,!0)])):d(``,!0)]),_:1},8,[`modelValue`]),f(Z,{modelValue:c.showSettingsDialog,"onUpdate:modelValue":o[19]||=e=>c.showSettingsDialog=e,title:`预警设置`,width:`700px`,center:``},{footer:r(()=>[f(g,{onClick:o[18]||=e=>c.showSettingsDialog=!1},{default:r(()=>[...o[72]||=[p(`取消`,-1)]]),_:1}),f(g,{type:`primary`,onClick:c.handleSaveSettings},{default:r(()=>[...o[73]||=[p(`保存设置`,-1)]]),_:1},8,[`onClick`])]),default:r(()=>[f(X,{model:c.settingsForm,"label-width":`120px`},{default:r(()=>[f(Q,{"content-position":`left`},{default:r(()=>[...o[64]||=[p(`通知设置`,-1)]]),_:1}),f(Y,{label:`邮件通知`},{default:r(()=>[f(q,{modelValue:c.settingsForm.emailEnabled,"onUpdate:modelValue":o[11]||=e=>c.settingsForm.emailEnabled=e},null,8,[`modelValue`]),o[65]||=y(`span`,{class:`form-tip`},`开启后预警将通过邮件发送通知`,-1)]),_:1}),f(Y,{label:`短信通知`},{default:r(()=>[f(q,{modelValue:c.settingsForm.smsEnabled,"onUpdate:modelValue":o[12]||=e=>c.settingsForm.smsEnabled=e},null,8,[`modelValue`]),o[66]||=y(`span`,{class:`form-tip`},`开启后预警将通过短信发送通知`,-1)]),_:1}),f(Y,{label:`App推送`},{default:r(()=>[f(q,{modelValue:c.settingsForm.appEnabled,"onUpdate:modelValue":o[13]||=e=>c.settingsForm.appEnabled=e},null,8,[`modelValue`]),o[67]||=y(`span`,{class:`form-tip`},`开启后预警将通过App推送通知`,-1)]),_:1}),f(Y,{label:`告警音`},{default:r(()=>[f(q,{modelValue:c.settingsForm.soundEnabled,"onUpdate:modelValue":o[14]||=e=>c.settingsForm.soundEnabled=e},null,8,[`modelValue`]),o[68]||=y(`span`,{class:`form-tip`},`开启后预警将播放提示音`,-1)]),_:1}),f(Q,{"content-position":`left`},{default:r(()=>[...o[69]||=[p(`高级设置`,-1)]]),_:1}),f(Y,{label:`预警间隔`},{default:r(()=>[f(S,{modelValue:c.settingsForm.interval,"onUpdate:modelValue":o[15]||=e=>c.settingsForm.interval=e,style:{width:`200px`}},{default:r(()=>[f(v,{label:`5分钟`,value:5}),f(v,{label:`10分钟`,value:10}),f(v,{label:`15分钟`,value:15}),f(v,{label:`30分钟`,value:30})]),_:1},8,[`modelValue`])]),_:1}),f(Y,{label:`自动恢复`},{default:r(()=>[f(q,{modelValue:c.settingsForm.autoRecover,"onUpdate:modelValue":o[16]||=e=>c.settingsForm.autoRecover=e},null,8,[`modelValue`]),o[70]||=y(`span`,{class:`form-tip`},`设备恢复正常后自动标记为已处理`,-1)]),_:1}),f(Y,{label:`数据保留天数`},{default:r(()=>[f(Pe,{modelValue:c.settingsForm.retentionDays,"onUpdate:modelValue":o[17]||=e=>c.settingsForm.retentionDays=e,min:7,max:365},null,8,[`modelValue`]),o[71]||=y(`span`,{class:`form-tip`},`预警记录保留天数`,-1)]),_:1})]),_:1},8,[`model`])]),_:1},8,[`modelValue`]),f(Z,{modelValue:c.showRuleDialog,"onUpdate:modelValue":o[28]||=e=>c.showRuleDialog=e,title:c.isEditRule?`编辑规则`:`新增规则`,width:`500px`,center:``},{footer:r(()=>[f(g,{onClick:o[27]||=e=>c.showRuleDialog=!1},{default:r(()=>[...o[74]||=[p(`取消`,-1)]]),_:1}),f(g,{type:`primary`,onClick:c.handleSubmitRule},{default:r(()=>[...o[75]||=[p(`保存`,-1)]]),_:1},8,[`onClick`])]),default:r(()=>[f(X,{model:c.ruleForm,rules:c.ruleFormRules,ref:`ruleFormRef`,"label-width":`100px`},{default:r(()=>[f(Y,{label:`规则名称`,prop:`ruleName`},{default:r(()=>[f(C,{modelValue:c.ruleForm.ruleName,"onUpdate:modelValue":o[20]||=e=>c.ruleForm.ruleName=e,placeholder:`请输入规则名称`},null,8,[`modelValue`])]),_:1}),f(Y,{label:`设备类型`,prop:`deviceType`},{default:r(()=>[f(S,{modelValue:c.ruleForm.deviceType,"onUpdate:modelValue":o[21]||=e=>c.ruleForm.deviceType=e,placeholder:`选择设备类型`,style:{width:`100%`}},{default:r(()=>[f(v,{label:`空调机组`,value:`ac`}),f(v,{label:`变压器`,value:`transformer`}),f(v,{label:`照明设备`,value:`lighting`}),f(v,{label:`电梯`,value:`elevator`}),f(v,{label:`给排水`,value:`water`})]),_:1},8,[`modelValue`])]),_:1}),f(Y,{label:`监控指标`,prop:`metric`},{default:r(()=>[f(C,{modelValue:c.ruleForm.metric,"onUpdate:modelValue":o[22]||=e=>c.ruleForm.metric=e,placeholder:`如：温度、电流、电压`},null,8,[`modelValue`])]),_:1}),f(Y,{label:`预警条件`,required:``},{default:r(()=>[f(H,{span:7},{default:r(()=>[f(Y,{prop:`operator`},{default:r(()=>[f(S,{modelValue:c.ruleForm.operator,"onUpdate:modelValue":o[23]||=e=>c.ruleForm.operator=e,placeholder:`比较符`},{default:r(()=>[f(v,{label:`大于`,value:`>`}),f(v,{label:`小于`,value:`<`}),f(v,{label:`等于`,value:`=`}),f(v,{label:`区间`,value:`between`})]),_:1},8,[`modelValue`])]),_:1})]),_:1}),f(H,{span:10,style:{"margin-left":`10px`}},{default:r(()=>[f(Y,{prop:`threshold`},{default:r(()=>[f(Pe,{modelValue:c.ruleForm.threshold,"onUpdate:modelValue":o[24]||=e=>c.ruleForm.threshold=e,precision:2,step:.1},null,8,[`modelValue`])]),_:1})]),_:1}),f(H,{span:5,style:{"margin-left":`10px`}},{default:r(()=>[f(Y,{prop:`unit`},{default:r(()=>[f(C,{modelValue:c.ruleForm.unit,"onUpdate:modelValue":o[25]||=e=>c.ruleForm.unit=e,placeholder:`单位`},null,8,[`modelValue`])]),_:1})]),_:1})]),_:1}),f(Y,{label:`预警级别`,prop:`level`},{default:r(()=>[f(S,{modelValue:c.ruleForm.level,"onUpdate:modelValue":o[26]||=e=>c.ruleForm.level=e,placeholder:`选择预警级别`,style:{width:`100%`}},{default:r(()=>[f(v,{label:`严重`,value:`critical`}),f(v,{label:`警告`,value:`warning`}),f(v,{label:`提示`,value:`info`})]),_:1},8,[`modelValue`])]),_:1})]),_:1},8,[`model`,`rules`])]),_:1},8,[`modelValue`,`title`])])}var H=g(C,[[`render`,V],[`__scopeId`,`data-v-e0029b2a`]]);export{H as default};