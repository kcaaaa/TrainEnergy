import{A as e,C as t,D as n,E as r,M as i,O as a,S as o,T as s,_ as c,b as l,c as u,d,f,g as p,h as m,j as h,k as g,n as _,p as v,r as y,t as b,u as x,w as S,x as C,y as w}from"./index-DexfLrHx.js";var T={name:`DeviceEnergyForecast`,setup(){let e=g(!1),t=g(!1),n=g(!1),r=g(!1),i=g(`day`),o=g(`7`),u=g(``),d=g(`lstm`),f=g(``),p=g(1),m=g(10),h=g(0),v=g(null),y=g(null),x=g(null),S=g(null),C=g(null),T=null,E=null,D=null,O=null,k=g({predictedConsumption:2456.78,trend:-5.2,accuracy:.94,peakHour:14,valleyHour:3,sampleCount:3650}),A=g(!0),j=g(`success`),M=g(`已训练`),N=g({timeRange:`2024-01-15 00:00 - 2024-01-16 00:00`,predictedValue:2456.78,confidenceLower:2312.45,confidenceUpper:2601.12,error:3.2,hourlyData:[{hour:0,value:85.2,percent:34},{hour:1,value:72.5,percent:29},{hour:2,value:68.3,percent:27},{hour:3,value:65.8,percent:26},{hour:4,value:68.2,percent:27},{hour:5,value:75.6,percent:30},{hour:6,value:95.8,percent:38},{hour:7,value:125.4,percent:50},{hour:8,value:145.6,percent:58},{hour:9,value:152.3,percent:61},{hour:10,value:158.7,percent:63},{hour:11,value:165.2,percent:66},{hour:12,value:168.5,percent:67},{hour:13,value:172.3,percent:69},{hour:14,value:178.6,percent:71},{hour:15,value:175.4,percent:70},{hour:16,value:168.2,percent:67},{hour:17,value:155.8,percent:62},{hour:18,value:142.5,percent:57},{hour:19,value:135.6,percent:54},{hour:20,value:128.4,percent:51},{hour:21,value:115.6,percent:46},{hour:22,value:98.5,percent:39},{hour:23,value:85.4,percent:34}]}),P=g([{id:`DEV001`,name:`1号空调机组`},{id:`DEV002`,name:`2号空调机组`},{id:`DEV003`,name:`主变压器`},{id:`DEV004`,name:`照明配电柜`},{id:`DEV005`,name:`电梯系统`}]),F=a({deviceId:``,model:`lstm`,period:`24h`,historyDays:90,remark:``}),I={deviceId:[{required:!0,message:`请选择设备`,trigger:`change`}],model:[{required:!0,message:`请选择预测模型`,trigger:`change`}],period:[{required:!0,message:`请选择预测周期`,trigger:`change`}],historyDays:[{required:!0,message:`请选择历史数据范围`,trigger:`change`}]},L=g([{id:`F20240115001`,deviceName:`1号空调机组`,model:`lstm`,forecastPeriod:`24h`,predictedValue:1256.78,accuracy:.95,createTime:`2024-01-15 08:00:00`,status:`completed`},{id:`F20240114002`,deviceName:`2号空调机组`,model:`prophet`,forecastPeriod:`24h`,predictedValue:986.45,accuracy:.92,createTime:`2024-01-14 08:00:00`,status:`completed`},{id:`F20240114003`,deviceName:`主变压器`,model:`arima`,forecastPeriod:`7d`,predictedValue:28564.12,accuracy:.89,createTime:`2024-01-14 00:00:00`,status:`completed`},{id:`F20240113004`,deviceName:`照明配电柜`,model:`xgboost`,forecastPeriod:`24h`,predictedValue:456.78,accuracy:.94,createTime:`2024-01-13 08:00:00`,status:`completed`},{id:`F20240113005`,deviceName:`电梯系统`,model:`lstm`,forecastPeriod:`7d`,predictedValue:1856.34,accuracy:.91,createTime:`2024-01-13 00:00:00`,status:`completed`}]),ee=()=>{y.value&&(T=b(y.value),R()),x.value&&(E=b(x.value),z()),S.value&&(D=b(S.value),B()),window.addEventListener(`resize`,V)},R=()=>{if(!T)return;let e=Array.from({length:24},(e,t)=>`${t}:00`),t=[85,72,68,66,68,76,96,125,145,152,158,165,168,172,178,175,168,155,142,135,128,115,98,85],n=[88,75,70,68,70,78,98,128,148,155,160,168,170,175,180,178,170,158,145,138,130,118,100,88],r=n.map(e=>e*1.05),i=n.map(e=>e*.95),a={tooltip:{trigger:`axis`,axisPointer:{type:`cross`}},legend:{data:[`实际能耗`,`预测能耗`,`置信区间`],bottom:10},grid:{left:`3%`,right:`4%`,bottom:`15%`,top:`10%`,containLabel:!0},xAxis:{type:`category`,boundaryGap:!1,data:e},yAxis:{type:`value`,name:`kWh`,axisLabel:{formatter:`{value}`}},series:[{name:`实际能耗`,type:`line`,data:t,smooth:!0,lineStyle:{width:2,color:`#409EFF`},itemStyle:{color:`#409EFF`}},{name:`预测能耗`,type:`line`,data:n,smooth:!0,lineStyle:{width:2,color:`#67C23A`},itemStyle:{color:`#67C23A`},areaStyle:{color:new _(0,0,0,1,[{offset:0,color:`rgba(103, 194, 58, 0.3)`},{offset:1,color:`rgba(103, 194, 58, 0.05)`}])}},{name:`置信区间`,type:`line`,data:r,lineStyle:{width:0,opacity:0},stack:`confidence`,symbol:`none`},{name:`置信区间`,type:`line`,data:i,lineStyle:{width:0,opacity:0},stack:`confidence`,symbol:`none`,areaStyle:{color:new _(0,0,0,1,[{offset:0,color:`rgba(103, 194, 58, 0.1)`},{offset:1,color:`rgba(103, 194, 58, 0.02)`}])}}]};T.setOption(a)},z=()=>{E&&E.setOption({tooltip:{trigger:`axis`},legend:{data:[`实际值`,`预测值`],bottom:10},grid:{left:`3%`,right:`4%`,bottom:`15%`,top:`10%`,containLabel:!0},xAxis:{type:`category`,data:[`01-09`,`01-10`,`01-11`,`01-12`,`01-13`,`01-14`,`01-15`]},yAxis:{type:`value`,name:`kWh`},series:[{name:`实际值`,type:`bar`,data:[2350,2420,2380,2510,2456,2490,2456],itemStyle:{color:`#409EFF`}},{name:`预测值`,type:`line`,data:[2320,2450,2400,2480,2500,2520,2480],smooth:!0,lineStyle:{width:2,color:`#67C23A`},itemStyle:{color:`#67C23A`}}]})},B=()=>{D&&D.setOption({tooltip:{trigger:`item`,formatter:`{b}: {c}次 ({d}%)`},legend:{bottom:10},series:[{name:`误差分布`,type:`pie`,radius:[`40%`,`70%`],avoidLabelOverlap:!1,itemStyle:{borderRadius:8,borderColor:`#fff`,borderWidth:2},label:{show:!1},emphasis:{label:{show:!0,fontSize:14,fontWeight:`bold`}},data:[{value:65,name:`±2%以内`,itemStyle:{color:`#67C23A`}},{value:25,name:`±2%~±5%`,itemStyle:{color:`#E6A23C`}},{value:8,name:`±5%~±10%`,itemStyle:{color:`#F56C6C`}},{value:2,name:`±10%以上`,itemStyle:{color:`#909399`}}]}]})},V=()=>{T?.resize(),E?.resize(),D?.resize(),O?.resize()},H=()=>{F.deviceId=``,F.model=`lstm`,F.period=`24h`,F.historyDays=90,F.remark=``,n.value=!0},U=async()=>{t.value=!0,setTimeout(()=>{t.value=!1,n.value=!1,L.value.unshift({id:`F${new Date().getTime().toString().slice(-10)}`,deviceName:P.value.find(e=>e.id===F.deviceId)?.name||`未知设备`,model:F.model,forecastPeriod:F.period===`24h`?`24小时`:F.period===`7d`?`7天`:`30天`,predictedValue:Math.random()*2e3+500,accuracy:.85+Math.random()*.1,createTime:new Date().toLocaleString(),status:`completed`}),h.value++},1500)},W=()=>{e.value=!0,j.value=`warning`,M.value=`训练中...`,setTimeout(()=>{e.value=!1,j.value=`success`,M.value=`已训练`,k.value.accuracy=.92+Math.random()*.05},3e3)};return w(()=>{c(()=>{ee()})}),l(()=>{window.removeEventListener(`resize`,V),T?.dispose(),E?.dispose(),D?.dispose(),O?.dispose()}),s(i,()=>{R()}),s(o,()=>{z()}),{loading:e,submitLoading:t,showForecastDialog:n,showDetailDialog:r,chartView:i,comparisonPeriod:o,selectedDevice:u,selectedModel:d,searchKeyword:f,currentPage:p,pageSize:m,totalRecords:h,forecastMetrics:k,hasForecastData:A,modelStatusType:j,modelStatusText:M,forecastDetail:N,deviceList:P,forecastForm:F,formRules:I,forecastRecords:L,forecastChartRef:y,comparisonChartRef:x,errorDistChartRef:S,detailChartRef:C,currentRecord:v,handleNewForecast:H,handleSubmitForecast:U,handleTrainModel:W,handleRetrain:()=>{W()},handleExport:()=>{},handleViewDetail:e=>{v.value=e,r.value=!0,c(()=>{if(C.value){O=b(C.value);let e={tooltip:{trigger:`axis`},xAxis:{type:`category`,data:Array.from({length:24},(e,t)=>`${t}:00`)},yAxis:{type:`value`,name:`kWh`},series:[{type:`line`,data:Array.from({length:24},()=>Math.random()*100+50),smooth:!0,lineStyle:{color:`#409EFF`},itemStyle:{color:`#409EFF`}}]};O.setOption(e)}})},handleDeleteRecord:e=>{let t=L.value.findIndex(t=>t.id===e.id);t>-1&&(L.value.splice(t,1),h.value--)},handleZoomReset:()=>{R()},handlePageSizeChange:()=>{},handlePageChange:()=>{},getModelName:e=>({lstm:`LSTM`,prophet:`Prophet`,arima:`ARIMA`,xgboost:`XGBoost`})[e]||e,getAccuracyStatus:e=>e>=.95?`excellent`:e>=.9?`good`:`warning`,getAccuracyLabel:e=>e>=.95?`优秀`:e>=.9?`良好`:`一般`,getAccuracyTagType:e=>e>=.95?`success`:e>=.9?`warning`:`danger`,getErrorClass:e=>e<=2?`excellent`:e<=5?`good`:`warning`}}},E={class:`device-energy-forecast`},D={class:`toolbar`},O={class:`toolbar-right`},k={key:0,class:`stats-section`},A={class:`metric-content`},j={class:`metric-header`},M={class:`metric-value`},N={class:`metric-content`},P={class:`metric-header`},F={class:`metric-value`},I={class:`metric-content`},L={class:`metric-header`},ee={class:`metric-value`},R={class:`metric-sub`},z={class:`metric-content`},B={class:`metric-header`},V={class:`model-status`},H={class:`model-info`},U={class:`model-actions`},W={key:1,class:`chart-section`},te={class:`card-header`},ne={class:`header-actions`},re={ref:`forecastChartRef`,class:`forecast-chart`},ie={class:`forecast-detail`},ae={class:`detail-section`},oe={class:`detail-grid`},se={class:`detail-item`},ce={class:`value`},le={class:`detail-item`},ue={class:`value highlight`},de={class:`detail-item`},fe={class:`value`},pe={class:`detail-item`},me={class:`detail-section`},he={class:`hourly-forecast`},ge={class:`hour`},_e={class:`hourly-bar`},ve={class:`hourly-value`},ye={class:`history-section`},be={class:`card-header`},xe={class:`header-actions`},Se={ref:`comparisonChartRef`,class:`comparison-chart`},Ce={ref:`errorDistChartRef`,class:`error-dist-chart`},we={class:`records-section`},Te={class:`card-header`},Ee={class:`header-actions`},De={class:`pagination-section`},Oe={key:0,class:`detail-dialog-content`},ke={class:`detail-chart`},Ae={ref:`detailChartRef`,class:`detail-forecast-chart`};function G(a,s,c,l,g,_){let y=t(`el-button`),b=t(`el-option`),w=t(`el-select`),T=t(`el-tooltip`),G=t(`el-card`),K=t(`el-col`),q=t(`el-tag`),J=t(`el-row`),Y=t(`el-radio-button`),je=t(`el-radio-group`),X=t(`el-input`),Z=t(`el-table-column`),Me=t(`el-table`),Ne=t(`el-pagination`),Q=t(`el-form-item`),Pe=t(`el-form`),Fe=t(`el-dialog`),$=t(`el-descriptions-item`),Ie=t(`el-descriptions`),Le=S(`loading`);return C(),v(`div`,E,[x(`div`,D,[p(y,{type:`primary`,onClick:l.handleNewForecast},{default:r(()=>[...s[15]||=[x(`i`,{class:`fa fa-plus`},null,-1),m(` 新建预测 `,-1)]]),_:1},8,[`onClick`]),p(y,{type:`success`,onClick:l.handleTrainModel},{default:r(()=>[...s[16]||=[x(`i`,{class:`fa fa-cogs`},null,-1),m(` 训练模型 `,-1)]]),_:1},8,[`onClick`]),p(y,{type:`info`,onClick:l.handleExport},{default:r(()=>[...s[17]||=[x(`i`,{class:`fa fa-download`},null,-1),m(` 导出报告 `,-1)]]),_:1},8,[`onClick`]),x(`div`,O,[p(w,{modelValue:l.selectedDevice,"onUpdate:modelValue":s[0]||=e=>l.selectedDevice=e,placeholder:`选择设备`,clearable:``,style:{width:`200px`}},{default:r(()=>[(C(!0),v(u,null,o(l.deviceList,e=>(C(),d(b,{key:e.id,label:e.name,value:e.id},null,8,[`label`,`value`]))),128))]),_:1},8,[`modelValue`]),p(w,{modelValue:l.selectedModel,"onUpdate:modelValue":s[1]||=e=>l.selectedModel=e,placeholder:`预测模型`,style:{width:`150px`,"margin-left":`10px`}},{default:r(()=>[p(b,{label:`LSTM`,value:`lstm`}),p(b,{label:`Prophet`,value:`prophet`}),p(b,{label:`ARIMA`,value:`arima`}),p(b,{label:`XGBoost`,value:`xgboost`})]),_:1},8,[`modelValue`])])]),l.forecastMetrics?(C(),v(`div`,k,[p(J,{gutter:20},{default:r(()=>[p(K,{span:6},{default:r(()=>[p(G,{shadow:`hover`,class:`metric-card`},{default:r(()=>[x(`div`,A,[x(`div`,j,[s[19]||=x(`span`,{class:`metric-label`},`预测能耗`,-1),p(T,{content:`未来24小时预测总能耗`,placement:`top`},{default:r(()=>[...s[18]||=[x(`i`,{class:`fa fa-info-circle`},null,-1)]]),_:1})]),x(`div`,M,i(l.forecastMetrics.predictedConsumption.toFixed(2)),1),s[20]||=x(`div`,{class:`metric-unit`},`kWh`,-1),x(`div`,{class:e([`metric-trend`,l.forecastMetrics.trend>0?`up`:`down`])},[x(`i`,{class:e([l.forecastMetrics.trend>0?`fa fa-arrow-up`:`fa fa-arrow-down`])},null,2),x(`span`,null,i(Math.abs(l.forecastMetrics.trend).toFixed(1))+`% 较昨日`,1)],2)])]),_:1})]),_:1}),p(K,{span:6},{default:r(()=>[p(G,{shadow:`hover`,class:`metric-card`},{default:r(()=>[x(`div`,N,[x(`div`,P,[s[22]||=x(`span`,{class:`metric-label`},`预测精度`,-1),p(T,{content:`模型预测准确度 (MAPE)`,placement:`top`},{default:r(()=>[...s[21]||=[x(`i`,{class:`fa fa-info-circle`},null,-1)]]),_:1})]),x(`div`,F,i((l.forecastMetrics.accuracy*100).toFixed(1)),1),s[23]||=x(`div`,{class:`metric-unit`},`%`,-1),x(`div`,{class:e([`metric-status`,l.getAccuracyStatus(l.forecastMetrics.accuracy)])},i(l.getAccuracyLabel(l.forecastMetrics.accuracy)),3)])]),_:1})]),_:1}),p(K,{span:6},{default:r(()=>[p(G,{shadow:`hover`,class:`metric-card`},{default:r(()=>[x(`div`,I,[x(`div`,L,[s[25]||=x(`span`,{class:`metric-label`},`峰谷预测`,-1),p(T,{content:`预测用电高峰与低谷时段`,placement:`top`},{default:r(()=>[...s[24]||=[x(`i`,{class:`fa fa-info-circle`},null,-1)]]),_:1})]),x(`div`,ee,i(l.forecastMetrics.peakHour)+`:00`,1),s[26]||=x(`div`,{class:`metric-unit`},`高峰时段`,-1),x(`div`,R,[x(`span`,null,`低谷: `+i(l.forecastMetrics.valleyHour)+`:00`,1)])])]),_:1})]),_:1}),p(K,{span:6},{default:r(()=>[p(G,{shadow:`hover`,class:`metric-card`},{default:r(()=>[x(`div`,z,[x(`div`,B,[s[28]||=x(`span`,{class:`metric-label`},`模型状态`,-1),p(T,{content:`当前预测模型训练状态`,placement:`top`},{default:r(()=>[...s[27]||=[x(`i`,{class:`fa fa-info-circle`},null,-1)]]),_:1})]),x(`div`,V,[p(q,{type:l.modelStatusType,size:`small`},{default:r(()=>[m(i(l.modelStatusText),1)]),_:1},8,[`type`])]),x(`div`,H,[x(`span`,null,`样本数: `+i(l.forecastMetrics.sampleCount),1)]),x(`div`,U,[p(y,{size:`mini`,type:`primary`,text:``,onClick:l.handleRetrain},{default:r(()=>[...s[29]||=[m(`重新训练`,-1)]]),_:1},8,[`onClick`])])])]),_:1})]),_:1})]),_:1})])):f(``,!0),l.hasForecastData?(C(),v(`div`,W,[p(J,{gutter:20},{default:r(()=>[p(K,{span:16},{default:r(()=>[p(G,{shadow:`hover`},{header:r(()=>[x(`div`,te,[s[34]||=x(`span`,null,`能耗预测曲线`,-1),x(`div`,ne,[p(je,{modelValue:l.chartView,"onUpdate:modelValue":s[2]||=e=>l.chartView=e,size:`small`},{default:r(()=>[p(Y,{label:`day`},{default:r(()=>[...s[30]||=[m(`日预测`,-1)]]),_:1}),p(Y,{label:`week`},{default:r(()=>[...s[31]||=[m(`周预测`,-1)]]),_:1}),p(Y,{label:`month`},{default:r(()=>[...s[32]||=[m(`月预测`,-1)]]),_:1})]),_:1},8,[`modelValue`]),p(y,{size:`small`,type:`text`,onClick:l.handleZoomReset},{default:r(()=>[...s[33]||=[x(`i`,{class:`fa fa-refresh`},null,-1),m(` 重置 `,-1)]]),_:1},8,[`onClick`])])])]),default:r(()=>[x(`div`,re,null,512)]),_:1})]),_:1}),p(K,{span:8},{default:r(()=>[p(G,{shadow:`hover`},{header:r(()=>[...s[35]||=[x(`div`,{class:`card-header`},[x(`span`,null,`预测详情`)],-1)]]),default:r(()=>[n((C(),v(`div`,ie,[x(`div`,ae,[s[40]||=x(`h4`,null,`未来24小时预测`,-1),x(`div`,oe,[x(`div`,se,[s[36]||=x(`span`,{class:`label`},`预测时间`,-1),x(`span`,ce,i(l.forecastDetail.timeRange),1)]),x(`div`,le,[s[37]||=x(`span`,{class:`label`},`预测能耗`,-1),x(`span`,ue,i(l.forecastDetail.predictedValue.toFixed(2))+` kWh`,1)]),x(`div`,de,[s[38]||=x(`span`,{class:`label`},`置信区间`,-1),x(`span`,fe,i(l.forecastDetail.confidenceLower.toFixed(2))+` - `+i(l.forecastDetail.confidenceUpper.toFixed(2))+` kWh`,1)]),x(`div`,pe,[s[39]||=x(`span`,{class:`label`},`预测误差`,-1),x(`span`,{class:e([`value`,l.getErrorClass(l.forecastDetail.error)])},` ±`+i(l.forecastDetail.error.toFixed(2))+`% `,3)])])]),x(`div`,me,[s[41]||=x(`h4`,null,`分时段预测`,-1),x(`div`,he,[(C(!0),v(u,null,o(l.forecastDetail.hourlyData,(e,t)=>(C(),v(`div`,{key:t,class:`hourly-item`},[x(`span`,ge,i(e.hour)+`:00`,1),x(`div`,_e,[x(`div`,{class:`bar-fill`,style:h({width:e.percent+`%`})},null,4)]),x(`span`,ve,i(e.value.toFixed(1))+` kWh`,1)]))),128))])])])),[[Le,l.loading]])]),_:1})]),_:1})]),_:1})])):f(``,!0),x(`div`,ye,[p(J,{gutter:20},{default:r(()=>[p(K,{span:12},{default:r(()=>[p(G,{shadow:`hover`},{header:r(()=>[x(`div`,be,[s[42]||=x(`span`,null,`历史预测对比`,-1),x(`div`,xe,[p(w,{modelValue:l.comparisonPeriod,"onUpdate:modelValue":s[3]||=e=>l.comparisonPeriod=e,size:`small`,style:{width:`120px`}},{default:r(()=>[p(b,{label:`近7天`,value:`7`}),p(b,{label:`近30天`,value:`30`}),p(b,{label:`近90天`,value:`90`})]),_:1},8,[`modelValue`])])])]),default:r(()=>[x(`div`,Se,null,512)]),_:1})]),_:1}),p(K,{span:12},{default:r(()=>[p(G,{shadow:`hover`},{header:r(()=>[...s[43]||=[x(`div`,{class:`card-header`},[x(`span`,null,`预测误差分布`)],-1)]]),default:r(()=>[x(`div`,Ce,null,512)]),_:1})]),_:1})]),_:1})]),x(`div`,we,[p(G,{shadow:`hover`},{header:r(()=>[x(`div`,Te,[s[44]||=x(`span`,null,`预测记录`,-1),x(`div`,Ee,[p(X,{modelValue:l.searchKeyword,"onUpdate:modelValue":s[4]||=e=>l.searchKeyword=e,placeholder:`搜索...`,"prefix-icon":`el-icon-search`,size:`small`,style:{width:`200px`},clearable:``},null,8,[`modelValue`])])])]),default:r(()=>[n((C(),d(Me,{data:l.forecastRecords,stripe:``,"row-key":`id`},{default:r(()=>[p(Z,{prop:`id`,label:`预测编号`,width:`120`}),p(Z,{prop:`deviceName`,label:`设备名称`,"min-width":`150`}),p(Z,{prop:`model`,label:`预测模型`,width:`100`,align:`center`},{default:r(e=>[p(q,{size:`small`},{default:r(()=>[m(i(l.getModelName(e.row.model)),1)]),_:2},1024)]),_:1}),p(Z,{prop:`forecastPeriod`,label:`预测周期`,width:`150`}),p(Z,{prop:`predictedValue`,label:`预测值`,width:`120`,align:`right`},{default:r(e=>[m(i(e.row.predictedValue.toFixed(2))+` kWh `,1)]),_:1}),p(Z,{prop:`accuracy`,label:`准确率`,width:`100`,align:`center`},{default:r(e=>[p(q,{type:l.getAccuracyTagType(e.row.accuracy),size:`small`},{default:r(()=>[m(i((e.row.accuracy*100).toFixed(1))+`% `,1)]),_:2},1032,[`type`])]),_:1}),p(Z,{prop:`createTime`,label:`预测时间`,width:`160`}),p(Z,{prop:`status`,label:`状态`,width:`100`,align:`center`},{default:r(e=>[p(q,{type:e.row.status===`completed`?`success`:`info`,size:`small`},{default:r(()=>[m(i(e.row.status===`completed`?`完成`:`进行中`),1)]),_:2},1032,[`type`])]),_:1}),p(Z,{label:`操作`,width:`150`,align:`center`,fixed:`right`},{default:r(e=>[p(y,{type:`primary`,size:`mini`,text:``,onClick:t=>l.handleViewDetail(e.row)},{default:r(()=>[...s[45]||=[x(`i`,{class:`fa fa-eye`},null,-1),m(` 查看 `,-1)]]),_:1},8,[`onClick`]),p(y,{type:`danger`,size:`mini`,text:``,onClick:t=>l.handleDeleteRecord(e.row)},{default:r(()=>[...s[46]||=[x(`i`,{class:`fa fa-trash`},null,-1),m(` 删除 `,-1)]]),_:1},8,[`onClick`])]),_:1})]),_:1},8,[`data`])),[[Le,l.loading]]),x(`div`,De,[p(Ne,{"current-page":l.currentPage,"onUpdate:currentPage":s[5]||=e=>l.currentPage=e,"page-size":l.pageSize,"onUpdate:pageSize":s[6]||=e=>l.pageSize=e,"page-sizes":[10,20,50,100],total:l.totalRecords,layout:`total, sizes, prev, pager, next, jumper`,onSizeChange:l.handlePageSizeChange,onCurrentChange:l.handlePageChange},null,8,[`current-page`,`page-size`,`total`,`onSizeChange`,`onCurrentChange`])])]),_:1})]),p(Fe,{modelValue:l.showForecastDialog,"onUpdate:modelValue":s[13]||=e=>l.showForecastDialog=e,title:`新建能耗预测`,width:`600px`,center:``},{footer:r(()=>[p(y,{onClick:s[12]||=e=>l.showForecastDialog=!1},{default:r(()=>[...s[47]||=[m(`取消`,-1)]]),_:1}),p(y,{type:`primary`,onClick:l.handleSubmitForecast,loading:l.submitLoading},{default:r(()=>[...s[48]||=[m(` 开始预测 `,-1)]]),_:1},8,[`onClick`,`loading`])]),default:r(()=>[p(Pe,{model:l.forecastForm,rules:l.formRules,ref:`forecastFormRef`,"label-width":`100px`},{default:r(()=>[p(Q,{label:`选择设备`,prop:`deviceId`},{default:r(()=>[p(w,{modelValue:l.forecastForm.deviceId,"onUpdate:modelValue":s[7]||=e=>l.forecastForm.deviceId=e,placeholder:`请选择设备`,style:{width:`100%`}},{default:r(()=>[(C(!0),v(u,null,o(l.deviceList,e=>(C(),d(b,{key:e.id,label:e.name,value:e.id},null,8,[`label`,`value`]))),128))]),_:1},8,[`modelValue`])]),_:1}),p(Q,{label:`预测模型`,prop:`model`},{default:r(()=>[p(w,{modelValue:l.forecastForm.model,"onUpdate:modelValue":s[8]||=e=>l.forecastForm.model=e,placeholder:`选择预测模型`,style:{width:`100%`}},{default:r(()=>[p(b,{label:`LSTM (长短期记忆网络)`,value:`lstm`}),p(b,{label:`Prophet (Facebook时序预测)`,value:`prophet`}),p(b,{label:`ARIMA (自回归移动平均)`,value:`arima`}),p(b,{label:`XGBoost (梯度提升树)`,value:`xgboost`})]),_:1},8,[`modelValue`])]),_:1}),p(Q,{label:`预测周期`,prop:`period`},{default:r(()=>[p(w,{modelValue:l.forecastForm.period,"onUpdate:modelValue":s[9]||=e=>l.forecastForm.period=e,placeholder:`选择预测周期`,style:{width:`100%`}},{default:r(()=>[p(b,{label:`未来24小时`,value:`24h`}),p(b,{label:`未来7天`,value:`7d`}),p(b,{label:`未来30天`,value:`30d`})]),_:1},8,[`modelValue`])]),_:1}),p(Q,{label:`历史数据`,prop:`historyDays`},{default:r(()=>[p(w,{modelValue:l.forecastForm.historyDays,"onUpdate:modelValue":s[10]||=e=>l.forecastForm.historyDays=e,placeholder:`选择历史数据范围`,style:{width:`100%`}},{default:r(()=>[p(b,{label:`最近30天`,value:30}),p(b,{label:`最近60天`,value:60}),p(b,{label:`最近90天`,value:90}),p(b,{label:`最近180天`,value:180})]),_:1},8,[`modelValue`])]),_:1}),p(Q,{label:`备注`},{default:r(()=>[p(X,{modelValue:l.forecastForm.remark,"onUpdate:modelValue":s[11]||=e=>l.forecastForm.remark=e,type:`textarea`,rows:3,placeholder:`请输入备注信息`},null,8,[`modelValue`])]),_:1})]),_:1},8,[`model`,`rules`])]),_:1},8,[`modelValue`]),p(Fe,{modelValue:l.showDetailDialog,"onUpdate:modelValue":s[14]||=e=>l.showDetailDialog=e,title:`预测详情`,width:`700px`,center:``},{default:r(()=>[l.currentRecord?(C(),v(`div`,Oe,[p(Ie,{column:2,border:``},{default:r(()=>[p($,{label:`预测编号`},{default:r(()=>[m(i(l.currentRecord.id),1)]),_:1}),p($,{label:`设备名称`},{default:r(()=>[m(i(l.currentRecord.deviceName),1)]),_:1}),p($,{label:`预测模型`},{default:r(()=>[m(i(l.getModelName(l.currentRecord.model)),1)]),_:1}),p($,{label:`预测周期`},{default:r(()=>[m(i(l.currentRecord.forecastPeriod),1)]),_:1}),p($,{label:`预测能耗`},{default:r(()=>[m(i(l.currentRecord.predictedValue.toFixed(2))+` kWh`,1)]),_:1}),p($,{label:`预测精度`},{default:r(()=>[m(i((l.currentRecord.accuracy*100).toFixed(1))+`%`,1)]),_:1}),p($,{label:`创建时间`},{default:r(()=>[m(i(l.currentRecord.createTime),1)]),_:1}),p($,{label:`状态`},{default:r(()=>[p(q,{type:l.currentRecord.status===`completed`?`success`:`info`,size:`small`},{default:r(()=>[m(i(l.currentRecord.status===`completed`?`完成`:`进行中`),1)]),_:1},8,[`type`])]),_:1})]),_:1}),x(`div`,ke,[x(`div`,Ae,null,512)])])):f(``,!0)]),_:1},8,[`modelValue`])])}var K=y(T,[[`render`,G],[`__scopeId`,`data-v-3e947641`]]);export{K as default};